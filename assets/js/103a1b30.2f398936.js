"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1796],{8122:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>a,frontMatter:()=>d,metadata:()=>c,toc:()=>o});var s=t(4848),i=t(8453);const d={},r=void 0,c={id:"cpp/thread",title:"thread",description:"std::thread",source:"@site/docs/cpp/thread.md",sourceDirName:"cpp",slug:"/cpp/thread",permalink:"/docs/cpp/thread",draft:!1,unlisted:!1,editUrl:"https://github.com/1036-ce/1036-ce.github.io/blob/main/docs/cpp/thread.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"template_class_friend_template_function",permalink:"/docs/cpp/template_class_friend_template_function"},next:{title:"tie",permalink:"/docs/cpp/tie"}},l={},o=[{value:"std::thread",id:"stdthread",level:2},{value:"std::this_thread",id:"stdthis_thread",level:2},{value:"method",id:"method",level:3},{value:"\u793a\u4f8b\u4ee3\u7801:",id:"\u793a\u4f8b\u4ee3\u7801",level:2}];function h(n){const e={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h2,{id:"stdthread",children:"std::thread"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"std::thread"}),"\u5bf9\u8c61\u8868\u793a\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5bf9\u8c61\u4e0e\u7ebf\u7a0b\u4e4b\u95f4\u662f\u4e00\u5bf9\u4e00\u7684\u5173\u7cfb\u3002\u7ebf\u7a0b\u5bf9\u8c61\u4e0d\u80fd\u88ab\u8d4b\u503c\u6216\u590d\u5236\uff0c\u4f46\u53ef\u4ee5\u79fb\u52a8"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:"// \u6784\u9020\u51fd\u6570\u5982\u4e0b\nexplicit thread(Function&& f, Args&& ...args);\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5728\u6784\u9020\u51fd\u6570\u6267\u884c\u5b8c\u6210\u540e\uff0c\u51fd\u6570\u4f1a",(0,s.jsx)(e.strong,{children:"\u7acb\u5373\u6267\u884c"})]}),"\n",(0,s.jsxs)(e.p,{children:["\u521b\u5efa\u7ebf\u7a0b\u540e\uff0c\u5fc5\u987b\u5728\u7ebf\u7a0b\u4e0a\u4f7f\u7528",(0,s.jsx)(e.code,{children:"join()"}),"\u6216",(0,s.jsx)(e.code,{children:"detach()"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"join()"}),"\uff1a \u963b\u585e\u8c03\u7528\u7ebf\u7a0b\u7684\u6267\u884c\uff0c\u76f4\u5230\u88ab\u8c03\u7528\u7ebf\u7a0b\u6267\u884c\u5b8c\u6210"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"detach()"}),": \u5141\u8bb8\u88ab\u8c03\u7528\u7ebf\u7a0b\u72ec\u7acb\u4e8e\u8c03\u7528\u7ebf\u7a0b\u7ee7\u7eed\u8fd0\u884c"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"stdthis_thread",children:"std::this_thread"}),"\n",(0,s.jsx)(e.h3,{id:"method",children:"method"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"yield()"}),": \u8ba9\u51fa\u5f53\u524d\u7ebf\u7a0b\u7684CPU\u65f6\u95f4\u7247\uff0c\u4ea4\u7ed9\u5176\u4ed6\u7ebf\u7a0b\u6267\u884c","\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:"// CPU \u5360\u7528\u9ad8\uff0c bad\nwhil(!isDone()) {}\n\n// CPU \u5360\u7528\u4f4e\uff0c good\nwhil(!isDone()) {\n    std::this_thread::yield();\n}\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"get_id()"}),": \u8fd4\u56de\u5f53\u524d\u7ebf\u7a0bid"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"sleep_for()"}),":  sleep\u4e00\u6bb5\u65f6\u95f4"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"sleep_until()"}),": sleep\u76f4\u5230\u67d0\u4e00\u7ed9\u5b9a\u65f6\u523b"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u793a\u4f8b\u4ee3\u7801",children:"\u793a\u4f8b\u4ee3\u7801:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:'#include <fmt/core.h>\n#include <iostream>\n#include <thread>\n\nusing namespace fmt;\n\nvoid sleepms(unsigned int ms) {\n\tusing std::chrono::milliseconds;\n\tstd::this_thread::sleep_for(milliseconds(ms));\n}\n\nvoid fthread(const int n) {\n\tstd::cout << format("This is t{}\\n", n);\n\tfor (int i = 0; i < 5; ++i) {\n\t\tsleepms(100 * n);\n\t\tstd::cout << format("t{}: {}\\n", n, i + 1);\n\t}\n\tstd::cout << format("Finishing t{}\\n", n);\n}\n\nint main() {\n\tstd::thread t1(fthread, 1);\n\tstd::thread t2(fthread, 2);\n\tstd::cout << "start of main()\\n";\n\tt1.join();\n\tt2.join(); \n\tstd::cout << "end of main()\\n";\n}\n\n// \u8f93\u51fa\u5982\u4e0b\uff1a\n/* This is t1\n * This is t2\n * t1: 1\n * t2: 1\n * t1: 2\n * t1: 3\n * t2: 2\n * t1: 4\n * t1: 5\n * Finishing t1\n * t2: 3\n * t2: 4\n * t2: 5\n * Finishing t2\n * end of main() */\n'})})]})}function a(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>c});var s=t(6540);const i={},d=s.createContext(i);function r(n){const e=s.useContext(d);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),s.createElement(d.Provider,{value:e},n.children)}}}]);