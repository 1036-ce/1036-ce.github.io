"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[599],{7986:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>u,contentTitle:()=>r,default:()=>l,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var o=e(4848),c=e(8453);const s={},r=void 0,i={id:"cpp/execution",title:"execution",description:"std::execution",source:"@site/docs/cpp/execution.md",sourceDirName:"cpp",slug:"/cpp/execution",permalink:"/docs/cpp/execution",draft:!1,unlisted:!1,editUrl:"https://github.com/1036-ce/1036-ce.github.io/blob/main/docs/cpp/execution.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"coroutines",permalink:"/docs/cpp/coroutines"},next:{title:"mutex",permalink:"/docs/cpp/mutex"}},u={},d=[{value:"std::execution",id:"stdexecution",level:2}];function a(n){const t={code:"code",h2:"h2",p:"p",pre:"pre",...(0,c.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"stdexecution",children:"std::execution"}),"\n",(0,o.jsx)(t.p,{children:"\u4f7f\u7528execution\u65f6\uff0c\u9700\u8981\u94fe\u63a5\u5230tbb\u5e93\uff0ccmake\u793a\u4f8b\u5982\u4e0b"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-cmake",children:"find_package(TBB REQUIRED COMPONENTS tbb)\ntarget_link_libraries(execution fmt::fmt tbb)\n"})}),"\n",(0,o.jsx)(t.p,{children:"\u5728\u4f7f\u7528\u5e76\u884c\u7b97\u6cd5\u65f6\uff0c\u505a\u5927\u91cf\u7684\u6d4b\u8bd5\u662f\u4e2a\u597d\u4e3b\u610f\u3002\u82e5\u7b97\u6cd5\u6216\u8c13\u8bcd\u672c\u8eab\u4e0d\u80fd\u5f88\u597d\u5730\u7528\u4e8e\u5e76\u884c\u5316\uff0c\u90a3\u4e48\u6700\u7ec8\u53ef\u80fd\u4f1a\u83b7\u5f97\u6700\u5c0f\u7684\u6027\u80fd\u589e\u76ca\uff0c\u6216\u51fa\u73b0\u610f\u60f3\u4e0d\u5230\u7684\u526f\u4f5c\u7528\u3002"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-cpp",children:'#include <chrono>\n#include <fmt/chrono.h>\n#include <fmt/format.h>\n#include <iostream>\n#include <execution>\n\nusing dur_t = std::chrono::duration<double, std::milli>;\n\nint main() {\n\tstd::vector<unsigned int> v(1000 * 1000);\n\tfor (int i = 0; i < v.size(); ++i)\n\t\tv.at(i) = i;\n\tauto mul2 = [](int n) { return n * 2; };\n\t// no policy\n\tauto t1 = std::chrono::steady_clock::now();\n\tstd::transform(v.begin(), v.end(), v.begin(), mul2);  // !here\n\tdur_t dur1 = std::chrono::steady_clock::now() - t1;\n\tstd::cout << fmt::format("no policy: {:.3}ms\\n", dur1.count());\n\n\t// seq\n\tt1 = std::chrono::steady_clock::now();\n\tstd::transform(std::execution::seq, v.begin(), v.end(), v.begin(), mul2); // !here\n\tdur1 = std::chrono::steady_clock::now() - t1;\n\tstd::cout << fmt::format("execution seq: {:.3}ms\\n", dur1.count());\n\n\t// par\n\tt1 = std::chrono::steady_clock::now();\n\tstd::transform(std::execution::par, v.begin(), v.end(), v.begin(), mul2); // !here\n\tdur1 = std::chrono::steady_clock::now() - t1;\n\tstd::cout << fmt::format("execution par: {:.3}ms\\n", dur1.count());\n\n\t// par_unseq\n\tt1 = std::chrono::steady_clock::now();\n\tstd::transform(std::execution::par_unseq, v.begin(), v.end(), v.begin(), mul2); //! here\n\tdur1 = std::chrono::steady_clock::now() - t1;\n\tstd::cout << fmt::format("execution par_unseq: {:.3}ms\\n", dur1.count());\n\treturn 0;\n}\n\n\n// \u8f93\u51fa\uff1a\n/**\nno policy: 14.9ms\nexecution seq: 16.5ms\nexecution par: 6.24ms\nexecution par_unseq: 2.16ms\n*/\n'})})]})}function l(n={}){const{wrapper:t}={...(0,c.R)(),...n.components};return t?(0,o.jsx)(t,{...n,children:(0,o.jsx)(a,{...n})}):a(n)}},8453:(n,t,e)=>{e.d(t,{R:()=>r,x:()=>i});var o=e(6540);const c={},s=o.createContext(c);function r(n){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function i(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:r(n.components),o.createElement(s.Provider,{value:t},n.children)}}}]);